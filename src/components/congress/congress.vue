<template>
    <div class="container">
        <div id="header">
            <!-- <img src="@/assets/common/img/congress.jpg"> -->
            <div class="row">
                <div class="col-xs-12">
                    <div class="search-wrapper">
                        <form class="formElem form-inline">
                            <div class="form-control-1 form-group">
                                <input type="text" placeholder="请选择要查看的届次" name="" class="form-control" />
                            </div>
                            <div class="form-control-2 form-group">
                                <label>国&nbsp;会</label>
                                <select type="" name="" class="form-control">
                                    <option>所有</option>
                                    <option>参议院</option>
                                    <option>众议院</option>
                                </select>
                            </div>
                            <div class="form-control-3 form-group">
                                <label>任&nbsp;期</label>
                                <input type="" name="" class="form-control" />
                            </div>
                            <div class="form-control-4 form-group">
                                <button type="submit" class="btn-search btn btn-default">search</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="body">
            <div class="row" id="congress">
                <div class="col-sm-12">
                    <h1 class="align-left"><span class="main-title badge badge-secondary">美国国会</span></h1>
                    <div class="text-muted">
                        <a>美国国会</a>（英语：United States Congress）是《美国宪法》规定的立法机构，位于国会大厦。根据《美国宪法》，美国是一个三权分立的国家，其中立法权力归国会；行政权力归美国总统；司法权力归美国联邦法院。国会由经直接选举产生的参议院议员与众议院议员组成，每个议员代表其选区内的选民，但是作为一个整体，国会议员代表整个国家的选民，通过立法来规范政府与人民的行为。
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="logo-img" href="#senate">
                        <img src="@/assets/common/img/170px-Seal_of_the_United_States_Senate.svg.png" style="margin-left:30%;">
                        <div class="logo-title" style="text-align:center;">美国参议院</div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="logo-img" href="#hor">
                        <img src="@/assets/common/img/170px-Seal_of_the_United_States_House_of_Representatives.svg.png" style="margin-left:30%;">
                        <div class="logo-title" style="text-align:center;">美国众议院</div>
                    </div>
                </div>
            </div>
            <div id="senate">
                <div class="col-xs-12">
                    <h1 class="align-left"><span class="main-title badge badge-secondary">参议院</span></h1>
                    <div class="text-muted">
                        <a>美利坚合众国参议院</a>（英语：United States Senate）是美国的立法机构──美国国会的两院之一，是美国的上议院，另一院为众议院。

                        参议院的组成和权力建基于美国宪法第一条第三款。美国每一州于联邦参议院中均有两位议员作为代表，与各州人口无关，所以全院员额为100名议员。参议员任期为六年，相互交错，每隔两年改选约三分之一的席位。根据美国宪法第一条第三款第四节，美国副总统兼任参议院议长，但无参议员资格；且除非是为了在表决平手时打破僵局，否则不得投票。

                        参议院公认较众议院更为审慎；参议员名额较少而任期较长，容许学院派看法与党派之见，较众议院更易置外于公共舆论。参议院拥有若干表列于宪法而未授予众议院的权力，其中最重要的是，美国宪法明列总统在批准条约或任命重要人事时，须“采酌参议院之建议并得其认可”，参议院拥有对内阁层级官员的同意权，总统提名的阁员均须得到参议院投票通过任命，此外，参议院亦拥有通过大法官人事任命的同意权，包括美国最高法院大法官。与其他民主国家相比，参议院单独拥有的权力较众议院单独拥有的权力更为重要，使得参议院所负的责任较众议院更广泛，亦更具政治影响力。
                    </div>
                </div>
                <div class="row">
                    <ul>
                        <li>
                            <div>
                                <div id="container1" style="width: 100%;height: 500px;margin:0 auto;"></div>
                                <div class="img-title">参议院政治、经济、领导力直方图</div>
                                <div class="text-muted">
                                    代表任务包含表达议员所在选区或者州的选民的意愿和需求，也包含并代表了更广范围内的国家利益，例如环境保护。因为选民意志经常和国家政策发生冲突，代表人物经常和影响国家的立法任务发生冲突。例如，虽然实行反倾销税可能对保护某些州内的产业有利，但是国家的出口可能会因为面临报复性反倾销税而受到损失。

                                    考虑到对于国家利益的代表，以及党派和团体之间的政治交易，议员有时也会做出与所在选区或者州的选民意志相背的行为。例如，尽管联邦党在纽约州占据多数，但是马丁·范布伦在任职纽约州参议员期间，经常投票拥护民主共和党对英国的军事行动。但是，为了成功选举连任起见，议员也经常倾听选民的心声来决定自己的立场，以及在投票时反对其所在的政党和团体。从严格的意义上来说，议员既不完全代表国家，也不完全代表所在选区或者州的选民，而是代表两者之间的混合体。
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="row">
                                <div class="col-sm-6">
                                    <div id="container5" style="width: 100%;height: 200px;margin:0 auto;"></div>
                                    <div class="img-title">参议院性别比例图</div>
                                </div>
                                <div class="col-sm-6">
                                    <div id="container6" style="width: 100%;height: 200px;margin:0 auto;"></div>
                                    <div class="img-title">参议院性别比例图</div>
                                </div>
                                <div class="col-sm-12 text-muted">
                                    代表任务包含表达议员所在选区或者州的选民的意愿和需求，也包含并代表了更广范围内的国家利益，例如环境保护。因为选民意志经常和国家政策发生冲突，代表人物经常和影响国家的立法任务发生冲突。例如，虽然实行反倾销税可能对保护某些州内的产业有利，但是国家的出口可能会因为面临报复性反倾销税而受到损失。

                                    考虑到对于国家利益的代表，以及党派和团体之间的政治交易，议员有时也会做出与所在选区或者州的选民意志相背的行为。例如，尽管联邦党在纽约州占据多数，但是马丁·范布伦在任职纽约州参议员期间，经常投票拥护民主共和党对英国的军事行动。但是，为了成功选举连任起见，议员也经常倾听选民的心声来决定自己的立场，以及在投票时反对其所在的政党和团体。从严格的意义上来说，议员既不完全代表国家，也不完全代表所在选区或者州的选民，而是代表两者之间的混合体。
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div>
                    <h2 class="align-left"><span class="main-title badge badge-secondary">参议员</span></h2>
                    <div class="col-sm-12">
                        <table class="table table-hover">
                            <tbody>
                                <tr v-for="(sen,index) in sens" :key="sen">
                                    <td>{{index}}</td>
                                    <td>
                                        <div class="person" v-for="(v,index) in sen" :key="v" @mouseenter="showps($event);" @mouseleave="hiddps($event)">
                                            <div class="person-brief">
                                            </div><a>{{v}}</a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="hor">
                <div class="col-xs-12">
                    <h1 class="align-left"><span class="main-title badge badge-secondary">众议院</span></h1>
                    <div class="text-muted">
                        <a>美利坚合众国众议院</a>（英语：United States House of Representatives）为美国国会两院之一，另一院为参议院。美国各州在众议院中拥有的席位比例以人口为基准，但至少会有一名议员。

                        院内议员总数经法律明定为435名。众议员任期两年，无连任限制。众议院议长由众议员选举产生，传统上为多数党之领导人。然而多数党领袖另由该多数党于院内之第二重要议员担任。据美国总统继位条例，众议院议长继任总统之顺序仅次于兼任参议院议长的副总统，为政坛上第三重要的领袖人物。
                    </div>
                </div>
                <div class="row">
                    <ul>
                        <li>
                            <div>
                                <div id="container2" style="width: 100%;height: 500px;margin:0 auto;"></div>
                                <div class="img-title">众议院政治、经济、领导力直方图</div>
                                <div class="text-muted">
                                    代表任务包含表达议员所在选区或者州的选民的意愿和需求，也包含并代表了更广范围内的国家利益，例如环境保护。因为选民意志经常和国家政策发生冲突，代表人物经常和影响国家的立法任务发生冲突。例如，虽然实行反倾销税可能对保护某些州内的产业有利，但是国家的出口可能会因为面临报复性反倾销税而受到损失。

                                    考虑到对于国家利益的代表，以及党派和团体之间的政治交易，议员有时也会做出与所在选区或者州的选民意志相背的行为。例如，尽管联邦党在纽约州占据多数，但是马丁·范布伦在任职纽约州参议员期间，经常投票拥护民主共和党对英国的军事行动。但是，为了成功选举连任起见，议员也经常倾听选民的心声来决定自己的立场，以及在投票时反对其所在的政党和团体。从严格的意义上来说，议员既不完全代表国家，也不完全代表所在选区或者州的选民，而是代表两者之间的混合体。
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div>
                    <h2 class="align-left"><span class="main-title badge badge-secondary">众议员</span></h2>
                    <div class="col-sm-12">
                        <table class="table table-hover">
                            <tbody>
                                <tr v-for="(hor,index) in hors" :key="hor">
                                    <td>{{index}}</td>
                                    <td>
                                        <div class="person" v-for="(v,i) in hor" :key="v" @mouseenter="showps($event);" @mouseleave="hiddps($event)">
                                            <div>
                                            </div>
                                            <a>{{v}}</a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<script type="text/javascript">
import Vue from "vue";
import echartGl from "echarts-gl";
import sens from "@/assets/common/json/person/sen.json";
import hors from "@/assets/common/json/person/hor.json";
import senNames1 from "@/assets/common/json/echarts/senNames1.json";
import senData1 from "@/assets/common/json/echarts/senData1.json";
import horData1 from "@/assets/common/json/echarts/horData1.json";
export default {
  data() {
    return {
      $echart: null,
      sens: sens,
      hors: hors,
      personal: null
    };
  },
  created() {},
  mounted() {
    this.initChart(); //参议院图
    this.initChart2(); //众议院图
    this.initChart5(); //参议院性别组成
    this.initChart6(); //众议院性别组成
  },
  beforeDestroy() {
    if (!this.$echart) {
      return;
    }
    this.$echart.dispose();
    this.$echart = null;
  },
  methods: {
    showps(e) {
      var pe = e.currentTarget.innerText;
      var person;
      var name;
      var img;
      var type;
      var party;
      var description;
      var economic;
      var social;
      var leadership;
      try {
        person = require("@/assets/common/json/person/" + pe + ".json");
        name = person.name;
        img = person.picture;
        type = person.type;
        party = person.party;
        description = person.description;
        economic = person.economic;
        social = person.social;
        leadership = person.leadership;
      } catch (err) {
        name = "";
        img = "";
        type = "";
        party = "";
        description = "";
        economic = 0;
        social = 0;
        leadership = 0;
      }
      var image = "";
      // var image = require('@/assets/common/img/person/default.jpg');
      // if(img)
      try {
        image = require("@/assets/common/img/person/" + img);
      } catch (err) {
        image = require("@/assets/common/img/person/default.jpg");
      }
      var subscript = require("@/assets/common/img/subscript1.png");
      this.personal =
        '<div class="personal" style="display: block;position: absolute;  margin-top: -340px; width: 300px; height: 310px; background-color: #2c3e50; z-index: 100; display: block; text-align: left; color: whitesmoke; border-radius:10px; box-shadow: 8px 8px 8px #888"><div><div class="effect" style="margin: 15px 20px;"><img style="position: absolute; top: 30px;width: 120px;  -webkit-box-shadow: 4px 4px 4px #888;  box-shadow: 4px 4px 4px #888;  border: 2px solid;" src="' +
        image +
        '"><div style="padding-left: 140px"><span style="line-height: 25px;width: 270px"><a style="display: block;">Economic</a><a class="score" style="display: block; font-size:2em; text-align: right; border-bottom: 1px solid #888; padding:3px">' +
        economic +
        '</a></span><span style="line-height: 25px;width: 270px"><a style="display: block;">Social</a><a class="score" style="display: block;font-size:2em; text-align: right; border-bottom: 1px solid #888; padding:3px">' +
        social +
        '</a></span><span style="line-height: 25px;width: 270px"><a style="display: block;">Leadership</a><a class="score" style="display: block;font-size:2em; text-align: right; border-bottom: 1px solid #888; padding:3px">' +
        leadership +
        '</a></span></div><div class="desc" style="font-size: 0.8em;  padding-top: 5px;  line-height: 35px; color: gold;"><div class="name" style="font-size: 1.4em;">Name:' +
        name +
        '</div><div class="party" style="font-size: 1.4em;text-align: center;">Party:' +
        party +
        '</div><div class="pos" style="font-size: 1.4em;text-align: right; padding-right: 20px">Position:' +
        type +
        '</div></div></div><div><img src="' +
        subscript +
        '" style="margin-top:-2px; padding-left:25px;width:80px;"></div></div></div>';

      var person = Vue.extend({
        template: this.personal
      });
      new person().$mount(e.currentTarget.firstElementChild);
    },
    hiddps(e) {
      var person = Vue.extend({
        template: "<div></div>"
      });
      new person().$mount(e.currentTarget.firstElementChild);
    },
    initChart() {
      var dom = document.getElementById("container1");
      var myChart = this.$echarts.init(dom);
      var app = {};
      var names = senNames1;
      var hours = ["Liberty", "conservative"];
      var days = ["Liberty", "conservative"];
      var data = senData1;
      myChart.setOption({
        tooltip: {
          formatter: function(params) {
            return (
              "姓名:" +
              names[params.dataIndex] +
              "<br/>" +
              "经济/再分配维度:" +
              params.value[1] +
              "<br/>" +
              "社会/种族维度:" +
              params.value[0] +
              "<br/>" +
              "领导力 :" +
              params.value[2]
            );
          }
        },
        visualMap: {
          max: 1.0,
          inRange: {
            color: [
              "#313695",
              "#4575b4",
              "#74add1",
              "#abd9e9",
              "#e0f3f8",
              "#ffffbf"
            ]
          }
        },
        xAxis3D: {
          name: "社会/种族维度",
          type: "value",
          max: 1,
          min: -1
          //        data: hours
        },
        yAxis3D: {
          name: "经济/再分配维度",
          type: "value",
          max: 1,
          min: -1
          //        data: days
        },
        zAxis3D: {
          name: "领导力",
          type: "value"
        },
        grid3D: {
          boxWidth: 100,
          boxDepth: 200,
          height: 500,
          viewControl: {
            //projection: 'orthographic'
          },
          light: {
            main: {
              intensity: 1.2,
              shadow: false
            },
            ambient: {
              intensity: 0.3
            }
          }
        },
        series: [
          {
            type: "bar3D",
            data: data.map(function(item) {
              return {
                value: [item.value[1], item.value[0], item.value[2]]
              };
            }),
            shading: "lambert",

            label: {
              textStyle: {
                show: true,
                formatter: "name",
                fontSize: 16,
                borderWidth: 1
              }
            },

            emphasis: {
              label: {
                textStyle: {
                  fontSize: 20,
                  color: "#900"
                }
              },
              itemStyle: {
                color: "#900"
              }
            }
          }
        ]
      });
    },
    initChart2() {
      var res = horData1;
      var a = getAttribute(res);
      var dom = document.getElementById("container2");
      var myChart = this.$echarts.init(dom);
      myChart.setOption({
        tooltip: {
          trigger: "item",
          formatter: function(params) {
            return (
              "姓名:" +
              params.data.name +
              "<br/>" +
              "选区:" +
              params.data.state_abbrev +
              params.data.district_code +
              "<br/>" +
              "政党:" +
              params.data.party +
              "<br/>" +
              "描述:" +
              params.data.description +
              "<br/>" +
              "社会/种族维度:" +
              params.value[1] +
              "<br/>" +
              "经济/再分配维度:" +
              params.value[0] +
              "<br/>" +
              "领导力 :" +
              params.value[2]
            );
          }
        },
        visualMap: {
          max: 1,
          min: -1,
          inRange: {
            color: [
              "#313695",
              "#4575b4",
              "#74add1",
              "#abd9e9",
              "#e0f3f8",
              "#ffffbf",
              "#f46d43",
              "#d73027"
            ]
          }
        },
        xAxis3D: {
          name: "社会/种族维度",
          type: "value"
        },
        yAxis3D: {
          name: "经济/再分配维度",
          type: "value"
        },
        zAxis3D: {
          name: "领导力",
          type: "value"
        },
        grid3D: {
          boxWidth: 100,
          boxDepth: 200,
          height: 500,
          viewControl: {},
          light: {
            main: {
              intensity: 1.2,
              shadow: false
            },
            ambient: {
              intensity: 0.3
            }
          }
        },
        series: [
          {
            type: "bar3D",
            data: a,
            shading: "lambert",

            label: {
              textStyle: {
                fontSize: 16,
                borderWidth: 1
              }
            },
            emphasis: {
              label: {
                textStyle: {
                  fontSize: 20,
                  color: "#900"
                }
              },
              itemStyle: {
                color: "#900"
              }
            }
          }
        ]
      });
    },
    initChart3() {
      // 基于准备好的dom，初始化echarts实例
      var myChart = this.$echarts.init(document.getElementById("container3"));
      // 指定图表的配置项和数据
      myChart.setOption({
        color: ["#DC143C", "#4169E1", "#4B0082"],
        title: {
          text: "Tenure of Senators",
          x: "center"
        },
        tooltip: {
          trigger: "axis",
          axisPointer: {
            // 坐标轴指示器，坐标轴触发有效
            type: "shadow" // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        legend: {
          data: ["Republicans", "Democrats", "Independents"],
          top: 25
        },
        grid: {
          left: "3%",
          right: "4%",
          bottom: "3%",
          containLabel: true
        },
        xAxis: {
          type: "value"
        },
        yAxis: {
          name: "Year Served in Congress",
          nameLocation: "center",
          nameGap: 90,
          nameTextStyle: {
            fontSize: 18
          },
          type: "category",
          data: [
            "0-5 years",
            "6-11 years",
            "12-17 years",
            "18-23 years",
            "24-29 years",
            "30-35 years",
            "36-41 years",
            "42-47 years"
          ]
        },
        series: [
          {
            name: "Republicans",
            type: "bar",
            stack: "总量",
            data: [12, 14, 7, 10, 2, 2, 3, 1]
          },
          {
            name: "Democrats",
            type: "bar",
            stack: "总量",
            data: [11, 18, 1, 4, 7, 2, 2, 2]
          },
          {
            name: "Independents",
            type: "bar",
            stack: "总量",
            data: [1, , , , 1, , ,]
          }
        ]
      });
    },
    initChart4() {
      // 基于准备好的dom，初始化echarts实例
      var myChart = this.$echarts.init(document.getElementById("container4"));

      // 指定图表的配置项和数据
      myChart.setOption({
        color: ["#DC143C", "#4169E1"],
        title: {
          text: "Tenure of Representatives",
          x: "center"
        },
        tooltip: {
          trigger: "axis",
          axisPointer: {
            // 坐标轴指示器，坐标轴触发有效
            type: "shadow" // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        legend: {
          top: 25,
          data: ["Republicans", "Democrats"]
        },
        grid: {
          left: "3%",
          right: "4%",
          bottom: "3%",
          containLabel: true
        },
        xAxis: {
          type: "value"
        },
        yAxis: {
          name: "Year Served in Congress",
          nameLocation: "center",
          nameGap: 90,
          nameTextStyle: {
            fontSize: 18
          },
          type: "category",
          data: [
            "0-3 years",
            "4-7 years",
            "8-11 years",
            "12-15 years",
            "16-19 years",
            "20-23 years",
            "24-27 years",
            "28-31 years",
            "32-35 years",
            "36-39 years",
            "44-47 years"
          ]
        },
        series: [
          {
            name: "Republicans",
            type: "bar",
            stack: "总量",
            data: [81, 74, 27, 22, 8, 10, 6, 5, 1, 3, 1]
          },
          {
            name: "Democrats",
            type: "bar",
            stack: "总量",
            data: [42, 48, 32, 16, 13, 16, 19, 9, 3, 1]
          }
        ]
      });
    },
    initChart5() {
      // 基于准备好的dom，初始化echarts实例
      var myChart = this.$echarts.init(document.getElementById("container5"));
      // 指定图表的配置项和数据
      myChart.setOption({
        color: ["black", "#6495ED"],
        title: {
          text: "Age and Sex of Senators",
          x: "center"
        },
        tooltip: {
          trigger: "axis",
          axisPointer: {
            // 坐标轴指示器，坐标轴触发有效
            type: "shadow" // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        legend: {
          top: 25,
          data: ["Women", "Men"]
        },
        grid: {
          left: "3%",
          right: "4%",
          bottom: "3%",
          containLabel: true
        },
        xAxis: {
          type: "value"
        },
        yAxis: {
          name: "Age",
          nameLocation: "center",
          nameGap: 90,
          nameTextStyle: {
            fontSize: 18
          },
          type: "category",
          data: ["42-64 years old", "65-85 years old"]
        },
        series: [
          {
            name: "Women",
            type: "bar",
            stack: "总量",
            data: [13, 10]
          },
          {
            name: "Men",
            type: "bar",
            stack: "总量",
            data: [40, 37]
          }
        ]
      });
    },
    initChart6() {
      // 基于准备好的dom，初始化echarts实例
      var myChart = this.$echarts.init(document.getElementById("container6"));
      // 指定图表的配置项和数据
      myChart.setOption({
        color: ["black", "#6495ED"],
        title: {
          text: "Age and Sex of Representatives",
          x: "center"
        },
        tooltip: {
          trigger: "axis",
          axisPointer: {
            // 坐标轴指示器，坐标轴触发有效
            type: "shadow" // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        legend: {
          top: 25,
          data: ["Women", "Men"]
        },
        grid: {
          left: "3%",
          right: "4%",
          bottom: "3%",
          containLabel: true
        },
        xAxis: {
          type: "value"
        },
        yAxis: {
          name: "Age",
          nameLocation: "center",
          nameGap: 90,
          nameTextStyle: {
            fontSize: 18
          },
          type: "category",
          data: ["34-60 years old", "61-88 years old"]
        },
        series: [
          {
            name: "Women",
            type: "bar",
            stack: "总量",
            data: [40, 50]
          },
          {
            name: "Men",
            type: "bar",
            stack: "总量",
            data: [185, 162]
          }
        ]
      });
    }
  }
};

function getAttribute(res) {
  var a = [];
  for (var i in res) {
    var b = {};
    b.name = res[i].bioname;
    b.value = [];
    b.chamber = res[i].chamber;
    b.state_abbrev = res[i].state_abbrev;
    b.district_code = res[i].district_code;
    b.party = res[i].party;
    b.description = res[i].description;
    b.value.push(res[i].nominate_dim2);
    b.value.push(res[i].nominate_dim1);
    b.value.push(res[i].leadership);
    a.push(b);
  }
  return a;
}

function createPersonal() {}
</script>



<style scoped>
@import "../../assets/common/css/congress.css";
</style>
